class Expressao {
    constructor(exp, flags) {
        if(exp instanceof Expressao){
            this.exp = String(exp.exp);
            this.flags = String(exp.flags);
        } else if(exp instanceof RegExp) {
            this.exp = exp.source;
            this.flags = exp.flags;
        } else {
            this.exp = arguments.length > 0 ? exp : '';
            this.flags = arguments.length > 1 ? flags : '';
        }
    }

    convert(e) {
        if(e instanceof RegExp)
            return e.source;
        else if(e instanceof Expressao)
            return e.exp;
        else
            return e;
    }

    or(e) {
        return new Expressao(this.exp + '|' + this.convert(e), this.flags);
    }

    prefix(p) {
        return new Expressao(this.convert(p) + this.exp, this.flags);
    }

    sufix(s) {
        return new Expressao(this.exp + this.convert(s), this.flags);
    }

    afix(pre, suf) {
        return new Expressao(this.convert(pre) + this.exp + this.convert(suf), this.flags);
    }

    setFlags(f) {
        return new Expressao(this.exp, f);
    }

    get regexp() {
        return new RegExp(this.exp, this.flags);
    }

    test(str) {
        return this.regexp.test(str);
    }

    exec(str) {
        return this.regexp.exec(str);
    }
}

exp = {};
exp.anoJudaico = new Expressao("anos?", 'i');
/*---------------------------- Pessoas ----------------------------*/
expPes = {};
expPes.adao = new Expressao(/Adão/g);
expPes.sete = new Expressao(/Sete/g);
expPes.enos = new Expressao(/Enos/g);
expPes.caina = new Expressao(/Cainã/g);
expPes.maalaleel = new Expressao(/Maalaleel/g);
expPes.jarede = new Expressao(/Jarede/g);
expPes.enoque = new Expressao(/Enoque/g);
expPes.matusalem = new Expressao(/Matusalém/g);
expPes.lameque = new Expressao(/Lameque/g);
expPes.noe = new Expressao(/Noé/g);

expVida = {};
!function() {
    var pes = Object.keys(expPes);
    var vidaPrefix = new Expressao(/duração da vida de /); //gen 5
    for (var i = 0; i < pes.length; i++) {
        var label = pes[i];
        var pessoa = expPes[pes[i]];
        expVida[label] = vidaPrefix.sufix(pessoa).or(pessoa).setFlags("g");
        /*document.body.innerHTML = document.body.innerHTML
                .replace(expVida[label].regexp, "<span class='teste'>$&</span>");*/
    }
}();

/* ---------------------- Unidades ---------------------- */
expNum = {};
expNum.zero = new Expressao(/\bzero\b/i);
expNum.um = new Expressao(/\bum\b/i);
expNum.dois = new Expressao(/\bdois\b/i);
expNum.tres = new Expressao(/\btrês\b/i);
expNum.quatro = new Expressao(/\bquatro\b/i);
expNum.cinco = new Expressao(/\bcinco\b/i);
expNum.seis = new Expressao(/\bseis\b/i);
expNum.sete = new Expressao(/\bsete\b/i);
expNum.oito = new Expressao(/\boito\b/i);
expNum.nove = new Expressao(/\bnove\b/i);
expNum.unidades = expNum.zero.or(expNum.um).or(expNum.dois).or(expNum.tres).or(expNum.quatro)
            .or(expNum.cinco).or(expNum.seis).or(expNum.sete).or(expNum.oito).or(expNum.nove)
            .setFlags('gi');

/* ---------------------- Dezenas ---------------------- */               
exp.dez = new Expressao("dez", "i");
exp.vinte = new Expressao("vinte", "i");

dataPeriodos = [
    { id:"anoJudaico", inicio: "1/1/0", fim: "5/13/0", label: "Ano Judaico", subPeriodos: ["abibe", "zive", "sivã", "tamuz", "abe", "elul", "etanim", "bul", "quisleu", "tebete", "sebate", "adar", "adar2"],
      regexp: /#/},
    { id:"abibe", regexp: /#/, inicio: "1/1/0",  fim: "30/1/0",  label: "Abibe",   subPeriodos: [] },
    { id:"zive", regexp: /#/, inicio: "1/2/0",  fim: "30/2/0",  label: "Zive",    subPeriodos: [] },
    { id:"sivã", regexp: /#/, inicio: "1/3/0",  fim: "30/3/0",  label: "Sivã",    subPeriodos: [] },
    { id:"tamuz", regexp: /#/, inicio: "1/4/0",  fim: "30/4/0",  label: "Tamuz",   subPeriodos: [] },
    { id:"abe", regexp: /#/, inicio: "1/5/0",  fim: "30/5/0",  label: "Abe",     subPeriodos: [] },
    { id:"elul", regexp: /#/, inicio: "1/6/0",  fim: "30/6/0",  label: "Elul",    subPeriodos: [] },
    { id:"etanim", regexp: /#/, inicio: "1/7/0",  fim: "30/7/0",  label: "Etanim",  subPeriodos: [] },
    { id:"bul", regexp: /#/, inicio: "1/8/0",  fim: "30/8/0",  label: "Bul",     subPeriodos: [] },
    { id:"quisleu", regexp: /#/, inicio: "1/9/0",  fim: "30/9/0",  label: "Quisleu", subPeriodos: [] },
    { id:"tebete", regexp: /#/, inicio: "1/10/0", fim: "30/10/0", label: "Tebete",  subPeriodos: [] },
    { id:"sebate", regexp: /#/, inicio: "1/11/0", fim: "30/11/0", label: "Sebate",  subPeriodos: [] },
    { id:"adar", regexp: /#/, inicio: "1/12/0", fim: "30/12/0", label: "Adar",    subPeriodos: [] },
    { id:"adar2", regexp: /#/, inicio: "1/13/0", fim: "5/13/0",  label: "",        subPeriodos: [] },
    
    { id:"anoGregoriano", regexp: /#/, inicio: "1/1/0", fim: "5/13/0", label: "Ano Gregoriano", subPeriodos: ["mar", "abr", "mai", "jun", "jul", "ago", "set", "out", "nov", "dez", "jan", "fev", "mar2"],},
    { id:"mar", regexp: /#/, inicio: "1/1/0",   fim: "10/1/0",  label: "Mar", subPeriodos: []},
    { id:"abr", regexp: /#/, inicio: "11/1/0",  fim: "10/2/0",  label: "Abr", subPeriodos: []},
    { id:"mai", regexp: /#/, inicio: "11/2/0",  fim: "11/3/0",  label: "Mai", subPeriodos: []},
    { id:"jun", regexp: /#/, inicio: "12/3/0",  fim: "11/4/0",  label: "Jun", subPeriodos: []},
    { id:"jul", regexp: /#/, inicio: "12/4/0",  fim: "12/5/0",  label: "Jul", subPeriodos: []},
    { id:"ago", regexp: /#/, inicio: "13/5/0",  fim: "13/6/0",  label: "Ago", subPeriodos: []},
    { id:"set", regexp: /#/, inicio: "14/6/0",  fim: "13/7/0",  label: "Set", subPeriodos: []},
    { id:"out", regexp: /#/, inicio: "14/7/0",  fim: "14/8/0",  label: "Out", subPeriodos: []},
    { id:"nov", regexp: /#/, inicio: "15/8/0",  fim: "14/9/0",  label: "Nov", subPeriodos: []},
    { id:"dez", regexp: /#/, inicio: "15/9/0",  fim: "15/10/0", label: "Dez", subPeriodos: []},
    { id:"jan", regexp: /#/, inicio: "16/10/0", fim: "16/11/0", label: "Jan", subPeriodos: []},
    { id:"fev", regexp: /#/, inicio: "17/11/0", fim: "14/12/0", label: "Fev", subPeriodos: []},
    { id:"mar2", regexp: /#/, inicio: "15/12/0", fim: "5/13/0",  label: "Mar", subPeriodos: []},
    
    { id:"contextoGenesis5", regexp: /#/, inicio: "1/1/0", fim: "5/13/2006", label: "Contexto Histórico de Gênesis 5", subPeriodos: [], },
    { id:"vidaAdao", inicio: "6/1/0", fim: "6/1/930", label: "Adão", subPeriodos: [], 
      regexp: expVida.adao},
    { id:"vidaSete", regexp: expVida.sete, inicio: "6/1/130", fim: "6/1/1042", label: "Sete", subPeriodos: []},
    { id:"vidaEnos", regexp: expVida.enos, inicio: "6/1/235", fim: "6/1/1140", label: "Enos", subPeriodos: []},
    { id:"vidaCaina", regexp: expVida.caina, inicio: "6/1/325", fim: "6/1/1235", label: "Cainã", subPeriodos: []},
    { id:"vidaMaalaleel", regexp: expVida.maalaleel, inicio: "6/1/395", fim: "6/1/1290", label: "Maalaleel", subPeriodos: []},
    { id:"vidaJarede", regexp: expVida.jarede, inicio: "6/1/460", fim: "6/1/1422", label: "Jarede", subPeriodos: []},
    { id:"vidaEnoque", regexp: expVida.enoque, inicio: "6/1/622", fim: "6/1/987", label: "Enoque", subPeriodos: []},
    { id:"vidaMatusalem", regexp: expVida.matusalem, inicio: "6/1/687", fim: "6/1/1656", label: "Matusalém", subPeriodos: []},
    { id:"vidaLameque", regexp: expVida.lameque, inicio: "6/1/874", fim: "6/1/1651", label: "Lameque", subPeriodos: []},
    { id:"vidaNoe", regexp: expVida.noe, inicio: "6/1/1056", fim: "6/1/2006", label: "Noé", subPeriodos: []},
    { id:"contextoNumeros1", regexp: /#/, inicio: "1/1/0", fim: "5/13/1",  label: "Contexto Histórico de Números 1", subPeriodos: ["anoSaidaEgito","ano1Recenceamento",], },
    { id:"anoSaidaEgito", regexp: /#/, inicio: "1/1/0", fim: "5/13/0", label: "Ano de saída do Egito", subPeriodos: [], },
    { id:"ano1Recenceamento", regexp: /#/, inicio: "1/1/1", fim: "5/13/1", label: "Ano do primeiro Recenseamento", subPeriodos: [], },
];

dataEventos = [
    { id: "recenseamento1", data: "1/2/1",  label: "Recenseamento" ,     regexp: /Recenseamento/},
    { id: "saidaEgito",     data: "15/1/0", label: "Saída do Egito",     regexp: /Saída do Egito/},
    { id: "nascimentoSete", data: "15/1/0", label: "Nascimento de Sete", regexp: /Nascimento de Sete/i},
];

dataTribos = [
    { id: 'triboRuben', nome: 'Rúben'},
    { id: 'triboSimeao', nome: 'Simeão' },
    { id: 'triboJuda', nome: 'Judá' },
    { id: 'triboIssacar', nome: 'Issacar' },
    { id: 'triboZebulom', nome: 'Zebulom' },
    { id: 'triboEfraim', nome: 'Efraim' },
    { id: 'triboManasses', nome: 'Manassés' },
    { id: 'triboBenjamim', nome: 'Benjamim' },
    { id: 'triboDa', nome: 'Dã' },
    { id: 'triboAser', nome: 'Aser' },
    { id: 'triboGade', nome: 'Gade' },
    { id: 'triboNaftali', nome: 'Naftali' },
    { id: 'triboLevi', nome: 'Levi', regexp: /Levi|[lL]evitas/},
];
dataTribos.forEach(function(tribo) {
    var prefix = new Expressao('tribo de ').or('descendentes de ').or('de ').or('filhos de ')
                                                                      .afix('(?:', ')?');
    var sufix = new Expressao(', foram recenseados ').or(' foi ').afix('(?:', ')')
                                                          .sufix(/([\d\.]*\b)(?: homens)?/);
    if(!tribo.regexp)
        tribo.regexp = new Expressao(tribo.nome, 'g').prefix(prefix).sufix(sufix);
    else
        tribo.regexp = new Expressao(tribo.regexp, 'g').prefix(prefix).sufix(sufix);
});

/* Cada lugar foi produzido a partir do site http://geojson.io/.
   Cada lugar trata-se de um objeto 'geometry' poduzido dentro do JSON gerado pelo site.
   Aperentemente os polígonos são gerados contrariamente à regra da mão direita. Por isso se fez necessário reordenalos como abaixo é feito. */
dataLugares = [
    { id: 'mundo', nome: '', regexp: new Expressao(/(?:)/),
      lugar: {"type":"Polygon","coordinates":[[[34.69482421875,31.92652373311596],[34.5135498046875,31.62765988554522],[34.2608642578125,31.351291407790594],[33.914794921875,31.177559742645535],[33.4918212890625,31.135252364697745],[33.101806640625,31.186958816798732],[32.8216552734375,31.07881316146105],[32.574462890625,31.064698120353743],[32.4041748046875,31.19400750999885],[32.222900390625,31.280898205011585],[31.931762695312496,31.51533734870699],[31.8548583984375,31.51533734870699],[31.571960449218746,31.433350262414432],[31.335754394531254,31.52704392483796],[31.085815429687496,31.597252561706686],[30.9320068359375,31.5668353078939],[30.780944824218746,31.52587333323968],[30.632629394531246,31.484893386890136],[30.47607421875,31.454439514853256],[30.37445068359375,31.480208820716904],[30.33599853515625,31.384123555094014],[30.26458740234375,31.294981054372307],[30.146484374999996,31.271508470221193],[30.069580078125,31.325486676506983],[29.792175292968754,31.139954117071454],[29.459838867187496,30.932856783043764],[29.069824218749996,30.810269662029924],[28.855590820312496,30.92578871258704],[28.605651855468746,31.034108344903512],[28.179931640625,31.076460800121122],[27.908020019531246,31.107036956407075],[27.85308837890625,31.243333658561443],[27.70751953125,31.177559742645535],[27.55096435546875,31.203404950917395],[27.41912841796875,31.231591672050616],[27.350463867187496,31.355982416708716],[27.13760375976563,31.37005403926066],[26.7791748046875,31.46381099222185],[26.422119140625004,31.496603776074124],[25.89752197265625,31.62298248226682],[25.24658203125,31.501287521196733],[25.048828125,31.907873056360206],[24.708251953125,32.01972036197235],[24.1424560546875,31.99643007718667],[23.97216796875,32.11747489684619],[23.741455078125,32.16863792635913],[23.2415771484375,32.238359405722655],[23.104248046875,32.61855682784329],[22.390136718749996,32.858825196463854],[22.1759033203125,32.92801287395169],[21.99462890625,32.89111950367499],[21.719970703125,32.92801287395169],[21.588134765625004,32.89111950367499],[20.5389404296875,32.53060504985312],[20.1983642578125,32.27552233695385],[19.9566650390625,31.968473925845107],[19.9237060546875,31.74451849197424],[20.006103515625,31.431006719178512],[20.1654052734375,31.158758795329728],[20.0555419921875,30.86686781614027],[19.830322265625,30.58354378627138],[20.214843749999996,11.305014428931411],[43.06640625,11.810899650277403],[43.39599609375,12.240707379385771],[42.16552734375,13.600608583816822],[40.68237304687501,14.878432678599394],[39.57275390625,15.556898478587641],[39.188232421875,16.707232312927637],[38.935546875,17.421408060413917],[38.55102539062499,18.059701055000478],[37.59521484375,18.768514546536892],[37.3974609375,19.03875247795315],[37.3095703125,19.32928669899883],[37.232666015625,20.022387362780314],[37.320556640625,21.051181240269408],[36.947021484375,21.52207216281315],[36.84814453125,22.0525504317147],[36.221923828125,22.631757630008703],[35.90332031250001,22.712856454141285],[35.672607421875,22.94574762338832],[35.48583984375,23.57153957947779],[35.7440185546875,23.973705011113754],[35.32104492187501,24.37461909460788],[34.991455078125,24.799201675373872],[34.442138671875,25.87158072084242],[34.12902832031251,26.389409326462555],[33.96423339843751,26.90492620106451],[33.793945312500014,27.276602318536376],[33.48083496093751,27.676231320549064],[33.563232421875,27.880356136180517],[32.9150390625,28.567637712798714],[32.64038085937501,29.135369220927185],[32.552490234375,29.403712311032496],[32.332763671875,29.633158589140564],[32.431640625,29.938275329718987],[32.53051757812501,30.033433263128995],[32.5634765625,29.966832283731033],[32.66235351562501,29.776297851831366],[32.750244140625,29.394140769211997],[33.14575195312501,29.068173545070536],[33.211669921875,28.58693349906797],[33.541259765625,28.258424894768172],[33.8104248046875,27.991976169784184],[34.134521484375,27.773481387145157],[34.310302734375,27.84150476761025],[34.44213867187499,28.016226126405652],[34.46411132812501,28.529035525107243],[34.6343994140625,28.813393375475773],[34.683837890625,29.221699149280646],[34.94476318359375,29.537619205973428],[34.61517333984376,28.103480741227482],[35.36224365234375,28.045318867211485],[37.20794677734376,25.217365923668318],[38.759765625,23.117627611920547],[39.0234375,21.491407966408477],[40.91308593749999,19.51578670986151],[42.38525390625,17.169658620146077],[42.802734375,16.18038632955662],[42.69287109375,15.228539583518842],[43.5498046875,12.712688391041072],[49.16107177734375,14.575609038170498],[52.76458740234376,16.3544033178772],[58.41156005859376,19.469181787843322],[59.60357666015625,22.611475436593377],[58.51043701171875,23.767750549280972],[56.23231887817383,24.818679062071936],[56.32372856140137,26.38871734489981],[55.32485246658326,25.42639648501998],[54.33904945850373,24.346632336422704],[51.824663579463966,24.12450617230284],[51.38045892119408,24.653953855669002],[51.487946435809135,25.831059716361022],[51.168155036866665,26.178905354450578],[50.681713046506054,25.63347463273696],[49.97706627007574,26.013255821079],[49.009508506860584,27.496503713222832],[48.130412034806795,29.013836408040056],[47.7567817675299,29.592499257337636],[48.734517415141454,30.12796007377926],[50.03637352019723,30.31876879215652],[50.63510462525301,29.40508382145509],[51.46968511864543,28.03314147109194],[53.5290277004242,26.879043061408687],[55.160937309265144,26.833070334400936],[56.41513824462891,27.119340740255964],[57.13233947753907,26.037658843057528],[60.676116943359375,24.9648951865082],[66.533203125,25.67618668495992],[67.70050048828125,24.07405146320328],[71.26556396484375,24.539627918861243],[70.16693115234375,26.718627100835956],[71.83685302734378,28.045318867211513],[75.00091552734375,32.447202799649354],[71.04583740234375,34.35477416538757],[71.57318115234375,38.179910014461136],[65.15716552734375,37.06613594074316],[61.72943115234375,35.6506010235913],[58.74114990234376,37.55546506818698],[53.90716552734376,37.415981841946106],[50.91888427734376,36.855449936136466],[48.54583740234375,38.52453288748689],[42.12982177734375,41.55175560133369],[39.04815673828126,40.91870134596723],[34.64813232421876,42.19596877629181],[30.769958496093754,41.33351365787323],[26.529235839843757,40.6493874545184],[26.309509277343754,38.71337568625477],[29.385681152343754,36.53832942872818],[32.72552490234376,36.13122001542852],[33.82415771484376,36.304058768042985],[34.65911865234376,36.86424015502008],[35.75775146484376,36.45442688547799],[35.84564208984375,35.22094130403182],[35.48583984375,33.813384329112786],[35.3045654296875,33.47727218776036],[35.2001953125,33.277731642555224],[35.2001953125,33.18583537264943],[35.123291015625,33.1398510418607],[35.04638671874999,32.844981178306114],[34.9639892578125,32.858825196463854],[34.8870849609375,32.46110854261064],[34.69482421875,31.92652373311596]]]}},
    { id: 'canaa', nome: 'Canaã', regexp: new Expressao(/terras? de Canaã|em Canaã/g),
      lugar: {"type":"Polygon","coordinates":[[[34.727783203125,32.001088607540446],[34.6563720703125,31.863562548378965],[34.46960449218749,31.59725256170666],[34.20043945312499,31.325486676506983],[34.244384765625,31.28793989264176],[34.266357421875,31.22689446881399],[34.310302734375,31.095278060807935],[34.3597412109375,30.968189296794247],[34.43115234375,30.798474179567823],[34.4915771484375,30.675715404167743],[34.530029296875,30.500750980290693],[34.530029296875,30.424992973925598],[34.595947265625,30.363396239603716],[34.6893310546875,30.14512718337613],[34.8101806640625,29.826348356278118],[34.859619140625,29.67850809103362],[34.859619140625,29.554345125748267],[34.903564453125,29.48742484748479],[34.9639892578125,29.511330027309146],[34.9749755859375,29.5830116903775],[35.00244140625,29.692824739380754],[35.04638671874999,29.816816857649936],[35.07385253906249,29.940655389125002],[35.1507568359375,30.107117887092382],[35.1397705078125,30.287531589298727],[35.19470214843749,30.315987718557867],[35.1727294921875,30.462879341709886],[35.2001953125,30.61427741282775],[35.2606201171875,30.675715404167743],[35.2935791015625,30.755998458321667],[35.3375244140625,30.817346256492073],[35.3704833984375,30.91636380602182],[35.419921875,30.958768570779846],[35.419921875,31.043521630684204],[35.4583740234375,31.12819929911196],[35.39794921875,31.2221970321032],[35.4034423828125,31.306715155075167],[35.4693603515625,31.423975737976722],[35.4638671875,31.50362930577303],[35.4913330078125,31.62064369245056],[35.55725097656249,31.76086695137955],[35.540771484375,31.835565983656227],[35.54901123046875,31.963813739260456],[35.518798828125,32.045332838858506],[35.5682373046875,32.22674287041067],[35.5517578125,32.393877575286446],[35.57647705078124,32.648625783736726],[35.7550048828125,32.75032260780972],[35.82916259765625,32.8219030154127],[35.88958740234375,32.9372338139709],[35.83465576171875,33.18813395605041],[35.782470703125,33.273139123013486],[35.8099365234375,33.30987251398259],[35.760498046875,33.33511774753217],[35.61492919921875,33.24098472320831],[35.57098388671875,33.29150775159364],[35.5462646484375,33.23639027157906],[35.4913330078125,33.089240433964726],[35.36773681640625,33.050112271849656],[35.30731201171875,33.10304621868762],[35.09857177734375,33.091541548655215],[35.08209228515625,32.96949953291244],[35.02716064453125,32.810361684869015],[34.96124267578125,32.828827094089085],[34.91455078125,32.61392993783568],[34.8760986328125,32.41938487611333],[34.81292724609375,32.224419385153006],[34.727783203125,32.001088607540446]]]}},
    { id: 'desertoDePara', nome: 'Deserto de Parã', regexp: new Expressao(/deserto de Parã/g),
      lugar: {"type":"Polygon","coordinates":[[[34.95849609375,29.563901551414418],[34.59045410156249,30.334953881988564],[33.892822265625,30.259067203213018],[33.431396484375,30.09286062952815],[33.33251953125,29.673735421779128],[33.6566162109375,29.29598055871569],[34.95849609375,29.563901551414418]]]} },
    { id: 'desertoDeZim', nome: 'Deserto de Zim', regexp: new Expressao(/deserto de Zim/gi),
      lugar: {"type":"Polygon","coordinates":[[[34.91180419921875,31.088222024691504],[34.76898193359375,31.019986671412497],[34.61517333984375,30.95876857077987],[34.42840576171875,30.885726447651578],[34.25262451171875,30.822063696500948],[34.1290283203125,30.763079047459023],[34.1619873046875,30.661540870820918],[34.1400146484375,30.56226095049944],[34.07684326171875,30.50548389892728],[34.024658203125,30.441570071519468],[34.0740966796875,30.36102635890718],[34.14825439453125,30.292274851024256],[34.21966552734375,30.247204606534158],[34.31304931640625,30.254322336443444],[34.4036865234375,30.273300428069934],[34.48883056640625,30.308874460573502],[34.5574951171875,30.391830328088137],[34.62066650390625,30.44393799829119],[34.65362548828125,30.517315187761888],[34.6893310546875,30.55989590270129],[34.7772216796875,30.585908257485578],[34.83489990234375,30.616641134091196],[34.881591796875,30.65445282440074],[34.9090576171875,30.680439786468128],[34.9420166015625,30.70878122625409],[34.9365234375,30.753638146218577],[34.9859619140625,30.784317689718897],[35.01068115234375,30.831497881307918],[35.07659912109375,30.869225348040825],[35.1287841796875,30.89279747750818],[35.17547607421875,30.925788712587014],[35.21942138671875,30.961123839411403],[35.22216796875,30.994091500316163],[35.17547607421875,31.036461753598545],[35.10406494140625,31.062345409804408],[35.0189208984375,31.05999264106237],[34.97222900390624,31.069403366864115],[34.91180419921875,31.088222024691504]]]}},
    { id: 'egito', nome: 'Egito', regexp: new Expressao(/Egito/g),
      lugar: {"type":"Polygon","coordinates":[[[34.21142578125,31.3348710339506],[33.55224609375,31.12819929911196],[32.4755859375,31.147006308556566],[31.838378906249996,31.522361470421437],[31.5087890625,31.44741029142872],[30.9814453125,31.615965936476076],[30.344238281249996,31.44741029142872],[29.77294921875,31.16580958786196],[29.20166015625,30.86451022625836],[28.937988281249996,30.845647420182598],[28.498535156249996,31.090574094954192],[27.97119140625,31.12819929911196],[27.861328125,31.259769987394286],[27.4658203125,31.2221970321032],[27.333984375,31.409912194070973],[26.78466796875,31.484893386890164],[25.90576171875,31.634675549541356],[25.444335937499996,31.541089879585808],[25.1806640625,31.57853542647338],[25.13671875,31.690781806136822],[24.93896484375,31.522361470421437],[24.85107421875,31.203404950917395],[25.0048828125,30.80791068136646],[24.89501953125,30.486550842588485],[24.697265625,30.12612436422458],[24.80712890625,29.80251790576445],[24.89501953125,29.439597566602902],[25.0048828125,29.075375179558346],[24.98291015625,22.004174972902003],[36.84814453125,22.024545601240337],[36.298828125,22.471954507739227],[36.03515625,22.715390019335942],[35.57373046875,22.917922936146045],[35.48583984375,23.36242859340884],[35.44189453125,23.926013033021203],[35.595703125,23.926013033021203],[35.7275390625,23.94609601499837],[35.419921875,24.16680208530324],[35.17822265625,24.487148563173438],[34.25537109375,26.15543796871355],[33.90380859375,26.667095801104814],[33.9697265625,26.843677401113002],[33.7939453125,27.27416111737468],[33.57421875,27.586197857692664],[33.5302734375,27.780771643348196],[33.134765625,28.246327971048842],[32.80517578125,28.67131091588086],[32.62939453125,28.97931203672246],[32.62939453125,29.267232865200878],[32.36572265625,29.49698759653577],[32.32177734374999,29.649868677972304],[32.45361328125,29.84064389983441],[32.54150390625,29.935895213372444],[32.6513671875,29.726222319395504],[32.71728515625,29.477861195816843],[32.9150390625,29.209713225868185],[33.0908203125,29.017748018496047],[33.1787109375,28.69058765425071],[33.37646484375,28.420391085674304],[33.75,28.05259082333986],[33.94775390625,27.858503954841247],[34.2333984375,27.877928333679495],[34.47509765625,28.033197847676377],[34.4091796875,28.38173504322308],[34.47509765625,28.536274512989916],[34.60693359375,28.8831596093235],[34.69482421875,29.113775395114416],[34.73876953125,29.36302703778376],[34.892578125,29.49698759653577],[34.21142578125,31.3348710339506]]]}},
    { id: 'neguebe', nome: 'Negueb', regexp: new Expressao(/Neguebe/g),
      lugar: {"type":"Polygon","coordinates":[[[34.6563720703125,31.863562548378965],[34.46960449218749,31.59725256170666],[34.20043945312499,31.325486676506983],[34.244384765625,31.28793989264176],[34.266357421875,31.22689446881399],[34.310302734375,31.095278060807935],[34.3597412109375,30.968189296794247],[34.43115234375,30.798474179567823],[34.4915771484375,30.675715404167743],[34.530029296875,30.500750980290693],[34.530029296875,30.424992973925598],[34.595947265625,30.363396239603716],[34.6893310546875,30.14512718337613],[34.8101806640625,29.826348356278118],[34.859619140625,29.67850809103362],[34.859619140625,29.554345125748267],[34.903564453125,29.48742484748479],[34.9639892578125,29.511330027309146],[34.9749755859375,29.5830116903775],[35.00244140625,29.692824739380754],[35.04638671874999,29.816816857649936],[35.07385253906249,29.940655389125002],[35.1507568359375,30.107117887092382],[35.1397705078125,30.287531589298727],[35.19470214843749,30.315987718557867],[35.1727294921875,30.462879341709886],[35.2001953125,30.61427741282775],[35.2606201171875,30.675715404167743],[35.2935791015625,30.755998458321667],[35.3375244140625,30.817346256492073],[35.3704833984375,30.91636380602182],[35.419921875,30.958768570779846],[35.419921875,31.043521630684204],[35.4583740234375,31.12819929911196],[35.39794921875,31.2221970321032],[35.4034423828125,31.306715155075167],[35.4693603515625,31.423975737976722],[35.4638671875,31.50362930577303],[35.4144287109375,31.49426181553272],[35.35400390625,31.475524020001806],[35.28808593749999,31.42866311735861],[35.2276611328125,31.3864682695423],[35.1177978515625,31.358327833411312],[35.0299072265625,31.363018491291182],[34.92553710937499,31.353636941500987],[34.8760986328125,31.400535326863935],[34.91455078125,31.47083898476439],[34.9365234375,31.60193125799097],[34.9090576171875,31.639352364896208],[34.8541259765625,31.737511125687828],[34.7882080078125,31.784216884487385],[34.6563720703125,31.863562548378965]]]}},
    { id: 'rioJordao', nome: 'Rio Jordão', regexp: new Expressao(/(?:Rio )?Jordão/gi),
      lugar: {"type":"LineString","coordinates":[[35.55793762207031,31.759626321325083],[35.55806636810302,31.765427948320106],[35.552916526794434,31.767215797788595],[35.55544853210449,31.771958904483967],[35.55192947387696,31.77378311154066],[35.54720878601074,31.78414392512728],[35.54274559020997,31.807487981686364],[35.547380447387695,31.837607687058213],[35.53974151611329,31.85459582386789],[35.54686546325684,31.868118476668933],[35.538668632507324,31.879962836234036],[35.53407669067383,31.89282590781842],[35.525922775268555,31.91158892248894],[35.53373336791992,31.924921089109414],[35.54098606109619,31.93814206679112],[35.54317474365235,31.96563415279747],[35.53519248962403,31.99169851505978],[35.52901268005372,32.01713688785102],[35.522832870483406,32.042568200496156],[35.53519248962403,32.07552016352836],[35.53467750549317,32.10315283021015],[35.54909706115723,32.12379915520803],[35.547895431518555,32.14153381727161],[35.558023452758796,32.15541387203676],[35.55227279663087,32.17205261757416],[35.55819511413575,32.18752610279868],[35.56325912475587,32.20263382272457],[35.567121505737305,32.22529069908488],[35.565834045410156,32.249321148718685],[35.56034088134766,32.27378066442221],[35.556306838989265,32.297580627868946],[35.556907653808594,32.33334138079092],[35.55673599243165,32.35676318267811],[35.55922508239746,32.37872920539018],[35.55716514587402,32.41931242240117],[35.56591987609864,32.437279160652025],[35.57184219360352,32.45611141329955],[35.568580627441406,32.47544659184596],[35.57716369628906,32.494777618395474],[35.56205749511719,32.51453875567289],[35.564031600952156,32.52691439859741],[35.567121505737305,32.53914362247354],[35.570640563964844,32.54449790638623],[35.571584701538086,32.55184143864324],[35.57501792907715,32.566201191466234],[35.57510375976563,32.59831241897488],[35.565576553344734,32.62318347873869],[35.56729316711426,32.640603565208586],[35.570297241210945,32.65339541037114],[35.556135177612305,32.674205348845035],[35.57038307189942,32.68822042292259],[35.56617736816407,32.70223329746514],[35.57956695556641,32.71104439078298]]} },
    { id: 'terraDeHamate', nome: 'Hamate', regexp: new Expressao(/\bHamate\b/g),
      lugar: {"type":"Polygon","coordinates":[[[37.729797363281264,35.12215510643691],[37.809448242187514,35.092945313732606],[37.856140136718764,35.007502842952874],[37.98522949218751,34.89719516961727],[38.070373535156264,35.02774729487061],[38.240661621093764,35.0996869642747],[38.229675292968764,35.14910869860162],[38.295593261718764,35.274774075037726],[38.295593261718764,35.38904996691164],[38.240661621093764,35.44277092585761],[37.963256835937514,35.427106012801346],[37.685852050781264,35.45619556834372],[37.55126953125002,35.516578738902936],[37.361755371093764,35.50092819950356],[37.218933105468764,35.552339944156174],[37.18872070312502,35.55010533588549],[37.164001464843764,35.48527461007848],[37.098083496093764,35.4517209363446],[37.073364257812514,35.40248356426934],[37.087097167968764,35.38457160381761],[37.125549316406264,35.413676519035754],[37.14202880859377,35.34201475584805],[37.026672363281264,35.32408937278177],[36.993713378906264,35.4181532656951],[36.922302246093764,35.35993616287673],[36.845397949218764,35.40024478679504],[36.815185546875014,35.42262976362143],[36.763000488281264,35.411438052435436],[36.680603027343764,35.38233232903296],[36.584472656250014,35.406960932701985],[36.587219238281264,35.40472227957221],[36.493835449218764,35.449483527031475],[36.427917480468764,35.427106012801346],[36.37847900390627,35.57915038479424],[36.411437988281264,35.72198780932869],[36.345520019531264,35.7175280069326],[36.323547363281264,35.74874138089811],[36.24664306640625,35.746512259918504],[36.20269775390625,35.68630240145625],[36.21917724609376,35.60595185369914],[36.208190917968764,35.48974737539361],[36.21917724609376,35.328571091254176],[36.252136230468764,35.16258214808429],[36.235656738281264,35.04124081149451],[36.158752441406264,35.00975247399121],[36.153259277343764,34.96474810049312],[36.21917724609376,34.96474810049312],[36.285095214843764,34.92422301690579],[36.312561035156264,34.87466516761258],[36.37847900390627,34.856636719051714],[36.433410644531264,34.856636719051714],[36.46087646484376,34.91521472314686],[36.510314941406264,34.95124196478962],[36.548767089843764,34.90170042871541],[36.614685058593764,34.91071020549452],[36.680603027343764,34.92422301690579],[36.77947998046877,34.95124196478962],[36.867370605468764,34.97375095431684],[36.933288574218764,34.92422301690579],[36.977233886718764,34.86565143737156],[37.070617675781264,34.91071020549452],[37.131042480468764,34.92422301690579],[37.21343994140626,34.92422301690579],[37.26287841796877,34.92422301690579],[37.323303222656264,34.978252010192556],[37.378234863281264,34.98725337980076],[37.471618652343764,34.97375095431684],[37.496337890625014,35.043489514314665],[37.729797363281264,35.12215510643691]]]}},

    /* ---------------------------------- PONTOS ---------------------------------- */
    { id: 'cades', nome: 'Cades-Barnea', regexp: new Expressao(/Cades/g),
      lugar: {"type": "Point","coordinates": [34.422222,30.648333]}},
    { id: 'eshcol', nome: 'Eshcol', regexp: new Expressao(/Eshcol/g), 
      lugar: {"type":"Point","coordinates":[35.105336,31.556536]}},
    { id: 'hamate', nome: 'Hamate', regexp: new Expressao(/\bHamate\b/g), 
      lugar: {"type":"Point","coordinates":[36.75,35.133333]}},
    { id: 'hebrom', nome: 'Hebrom', regexp: new Expressao(/Hebrom|Quiriate-Arba/g),
      lugar: {"type":"Point","coordinates":[35.095,31.533333]}},
    { id: 'reobe', nome: 'Reobe', regexp: new Expressao(/Reobe/g),
      lugar: {"type":"Point","coordinates":[35.498242,32.457125]}},
    { id: 'zoa', nome: 'Zoã', regexp: new Expressao(/Zoã/g), 
      lugar: {"type":"Point","coordinates":[31.88,30.976944]}},
];

/*Invertendo sentido dos pontos especificados em cada polígono*/
dataLugares.forEach(function(d) {
    if(d.lugar.type === 'FeatureCollection')
        d.lugar.features.forEach(function(d) {
            if(d.geometry.type === 'Polygon')
                for(let i = 0; i < d.geometry.coordinates.length; i++){
                    d.geometry.coordinates[i] = d.geometry.coordinates[i].reverse();
                    //console.log('invert', d.geometry.coordinates[i]);
                }
        });
});
dataLugares.forEach(function(d) {
    if(d.lugar.type === 'Polygon')
        for(let i = 0; i < d.lugar.coordinates.length; i++) 
            d.lugar.coordinates[i] = d.lugar.coordinates[i].reverse();
});